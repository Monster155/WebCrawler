<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover,maximum-scale=1,user-scalable=0">
  <meta name="referrer" content="unsafe-url">
  <title>DCSync: особенности выполнения атаки и возможные варианты детектирования, Часть 2 / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }

    /* non-breaking hyphen */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/l/font?kit=KFOlCnqEu92Fr1MmEU9vBh0_IsHAlmrO6g&skey=ee881451c540fdec&v=v29) format('woff2');
      unicode-range: U+02011;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.b6238726.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.2287bfbd.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.8d73f026.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.58744b80.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/js/7298.c8f1d73c.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.b6238726.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.8d73f026.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.99fdff73029c662d76a25e7927355795.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/company\/rvision\/blog\/709942\/"},"headline":"DCSync: особенности выполнения атаки и возможные варианты детектирования, Часть 2","datePublished":"2023-01-19T12:07:46+03:00","dateModified":"2023-01-19T13:42:15+03:00","author":{"@type":"Person","name":"rvteam"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Привет, Хабр! В предыдущей статье мы разобрали основы и механизмы работы атаки DCSync, а также рассмотрели несколько наиболее популярных утилит для ее реализации...","url":"https:\/\/habr.com\/ru\/company\/rvision\/blog\/709942\/#post-content-body","about":["c_rvision","h_infosecurity","f_develop"],"image":["https:\/\/habr.com\/share\/publication\/709942\/81b7a8c98e496fd7eb7e5f132503e954\/","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/3b8\/6b1\/e83\/3b86b1e839a172bc80303d38d0b2bca8.jpg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/32b\/368\/845\/32b36884590a465e74135611447766da.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/432\/9f1\/933\/4329f1933451389e5b3a2380e2254039.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/387\/a38\/373\/387a383731f1912660dc974f0f079b9b.png","https:\/\/habrastorage.org\/r\/w1560\/getpro\/habr\/upload_files\/474\/2a1\/4aa\/4742a14aa52ac0c66aa287ac3c9ca250.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/ff6\/369\/ed9\/ff6369ed9b8be2e585b2c3586e5f8607.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/305\/b01\/539\/305b01539c346e40c6831c95d566265b.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/baa\/26d\/bd7\/baa26dbd7414168fae81ea22cf15b288.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/13a\/965\/92b\/13a96592bb09fdc120cf75b03e9ebcc1.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/a86\/f85\/511\/a86f8551141d86e6e0f2cbd16a10e532.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/0d7\/098\/db3\/0d7098db3a648261695be50fc51ec3e3.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/8fe\/377\/df8\/8fe377df8c142358ceae1455f240b59e.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.113.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_com"><meta data-vue-meta="ssr" property="og:site_name" content="Хабр" data-vmid="og:site_name"><meta data-vue-meta="ssr" property="og:title" content="DCSync: особенности выполнения атаки и возможные варианты детектирования, Часть 2" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="DCSync: особенности выполнения атаки и возможные варианты детектирования, Часть 2" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="DCSync: особенности выполнения атаки и возможные варианты детектирования, Часть 2" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Привет, Хабр! В предыдущей статье мы разобрали основы и механизмы работы атаки DCSync, а также рассмотрели несколько наиболее популярных утилит для ее реализации: mimikatz, secretsdump, DSInternals и..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Привет, Хабр! В предыдущей статье мы разобрали основы и механизмы работы атаки DCSync, а также рассмотрели несколько наиболее популярных утилит для ее реализации: mimikatz, secretsdump, DSInternals и..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Привет, Хабр! В предыдущей статье мы разобрали основы и механизмы работы атаки DCSync, а также рассмотрели несколько наиболее популярных утилит для ее реализации: mimikatz, secretsdump, DSInternals и..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Привет, Хабр! В предыдущей статье мы разобрали основы и механизмы работы атаки DCSync, а также рассмотрели несколько наиболее популярных утилит для ее реализации: mimikatz, secretsdump, DSInternals и..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Привет, Хабр! В предыдущей статье мы разобрали основы и механизмы работы атаки DCSync, а также рассмотрели несколько наиболее популярных утилит для ее реализации: mimikatz, secretsdump, DSInternals и..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habrastorage.org/getpro/habr/upload_files/a08/e80/15b/a08e8015bcb9d00ed752ececdd6ba736.jpg" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habrastorage.org/getpro/habr/upload_files/a08/e80/15b/a08e8015bcb9d00ed752ececdd6ba736.jpg" data-vmid="og:image"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habrastorage.org/getpro/habr/upload_files/a08/e80/15b/a08e8015bcb9d00ed752ececdd6ba736.jpg" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habrastorage.org/getpro/habr/upload_files/a08/e80/15b/a08e8015bcb9d00ed752ececdd6ba736.jpg" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habrastorage.org/getpro/habr/upload_files/a08/e80/15b/a08e8015bcb9d00ed752ececdd6ba736.jpg?format=vk" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="709942" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2023-01-19T09:07:46.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" content="https://habr.com/ru/company/rvision/blog/709942/" property="og:url" data-vmid="og:url"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" name="keywords" content="атака, dcsync, детектирование, выявление атак, обнаружение атаки, detect, вызов функции, события журнала, анализ событий">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/709942/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/company/rvision/blog/709942/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" rel="image_src" href="https://habrastorage.org/getpro/habr/upload_files/a08/e80/15b/a08e8015bcb9d00ed752ececdd6ba736.jpg" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/709942/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
  <script async src="https://unpkg.com/pwacompat" crossorigin="anonymous"></script>
  <script>window.yaContextCb = window.yaContextCb || []</script>
  <script src="https://yandex.ru/ads/system/context.js" async></script>
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_dark"><title>Профиль</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" companyName="rvision" data-async-called="true" class="tm-page"><div class="tm-page-width"><div class="tm-page__header"><!----></div> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><!----> <div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"><div class="tm-company-profile-card tm-company-article__profile-card"><div class="tm-company-card tm-company-profile-card__info"><div class="tm-company-card__header"><a href="/ru/company/rvision/profile/" class="tm-company-card__avatar"><div class="tm-entity-image"><img alt="" height="48" src="//habrastorage.org/getpro/habr/company/9bc/04c/e86/9bc04ce8696b66f2315dafe9a35ce5b8.jpg" width="48" class="tm-entity-image__pic"></div></a> <a href="https://career.habr.com/companies/rvision" rel="noopener" target="_blank" class="tm-grade tm-company-card__rating"><div class="tm-counter-container"><div class="tm-counter-container__header"><svg height="24" width="24" class="tm-svg-img tm-svg-grade__icon"><title>Оценка компании на Хабр Карьере</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#grade"></use></svg> <div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-grade"><!----> <div class="tm-votes-lever__score tm-votes-lever__score tm-votes-lever__score_appearance-grade"><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter tm-votes-lever__score-counter_grade">
        4.78
      </span></div> <!----></div></div> <div class="tm-counter-container__footer"><span class="tm-rating__text tm-rating__text tm-rating__text_variant-grade">
      Оценка
    </span></div></div></a> <div class="tm-counter-container tm-company-card__rating"><div class="tm-counter-container__header"> <div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating"><!----> <div class="tm-votes-lever__score tm-votes-lever__score tm-votes-lever__score_appearance-rating"><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter tm-votes-lever__score-counter_rating">
        90.31
      </span></div> <!----></div></div> <div class="tm-counter-container__footer"><span class="tm-rating__text tm-rating__text">
      Рейтинг
    </span></div></div> <!----></div> <div class="tm-company-card__info"><a href="/ru/company/rvision/profile/" class="tm-company-card__name">R-Vision</a> <div class="tm-company-card__description">Разработчик систем кибербезопасности</div></div></div> <!----></div> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet tm-article-snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/rvteam/" title="rvteam" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="//habrastorage.org/r/w32/getpro/habr/avatars/c9f/0ee/0a8/c9f0ee0a875a62b1f2b52cd61166ffe5.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/rvteam/" class="tm-user-info__username">
      rvteam
      <!----></a> <span class="tm-article-datetime-published"><time datetime="2023-01-19T09:07:46.000Z" title="2023-01-19, 12:07">19  янв   в 12:07</time></span></span></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>DCSync: особенности выполнения атаки и возможные варианты детектирования, Часть 2</span></h1> <div class="tm-article-snippet__stats"><!----> <div class="tm-article-reading-time"><span class="tm-svg-icon__wrapper tm-article-reading-time__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Время на прочтение</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#clock"></use></svg></span> <span class="tm-article-reading-time__label">
    7 мин
  </span></div> <span class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#counter-views"></use></svg> <span class="tm-icon-counter__value">1.2K</span></span></div> <div class="tm-article-snippet__hubs-container"><div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/company/rvision/blog/" class="tm-article-snippet__hubs-item-link router-link-active"><span>Блог компании R-Vision</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/infosecurity/" class="tm-article-snippet__hubs-item-link"><span>Информационная безопасность</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div></div> <div class="tm-article-snippet__labels-container"><div class="tm-article-snippet__labels"><div class="tm-article-snippet__label tm-article-snippet__label_variant-tutorial"><span>
          Туториал
        </span></div> </div></div> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div></div> <div id="post-content-body"><div><div class="article-formatted-body article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><figure class="full-width "><img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/3b8/6b1/e83/3b86b1e839a172bc80303d38d0b2bca8.jpg" width="2560" height="1709" data-src="https://habrastorage.org/getpro/habr/upload_files/3b8/6b1/e83/3b86b1e839a172bc80303d38d0b2bca8.jpg" data-blurred="true"/><figcaption></figcaption></figure><p>Привет, Хабр! В <a href="https://habr.com/ru/company/rvision/blog/709866/">предыдущей статье </a>мы разобрали основы и механизмы работы атаки DCSync, а также рассмотрели несколько наиболее популярных утилит для ее реализации: <strong>mimikatz, secretsdump, DSInternals </strong>и<strong> </strong>существующие между ними отличия. В результате мы обнаружили, что у всех утилит прослеживается один и тот же принцип проведения атаки и присутствует одинаковый фактор для ее выявления <em>–</em> <em>DRSReplicaSync</em>. </p><p>В этой части мы сфокусируемся на возможных способах детектирования атаки DCSync. <br/>Для построения возможной логики выявления атаки сперва нам необходимо изучить какие события и в каких журналах мы можем увидеть в результате запуска утилит, которые впоследствие могут лечь в основу детекта. Давайте приступим.</p><h2>Анализ событий RPC</h2><p>Ранее, при разборе кодовой базы утилит мы увидели, что при репликации данных используются вызовы RPC функций. Вызов RPC функций можно отследить с помощью технологии <a href="https://learn.microsoft.com/en-us/windows-hardware/test/wpt/event-tracing-for-windows">Event Tracing for Windows</a> (ETW) и её провайдера <em>Microsoft-Windows-RPC</em>. <br/>RPC функции однозначно идентифицируются по номеру интерфейса, его <em>UUID</em>, и номеру операции - <em>opnum</em> / <em>procmon</em>. При этом номер интерфейса распознает группу связанных удаленных функций. Функциям <em>DRSUAPI</em> соответствует идентификатор UUID <a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-drsr/063618ed-b2e2-4983-ab13-3ed056700641"><em>e3514235-4b06-11d1-ab04-00c04fc2dcd2</em></a>.</p><figure class=""><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/32b/368/845/32b36884590a465e74135611447766da.png" alt="Рисунок 22 - Подключение к RPC EPM, расположенному на порту 135" title="Рисунок 22 - Подключение к RPC EPM, расположенному на порту 135" width="auto" height="auto" data-src="https://habrastorage.org/getpro/habr/upload_files/32b/368/845/32b36884590a465e74135611447766da.png"/><figcaption>Рисунок 22 - Подключение к RPC EPM, расположенному на порту 135</figcaption></figure><p>Как видно из полученных логов (рисунок 22), на первом этапе происходит подключение клиента по порту 135 к протоколу удаленного вызова процедур (RPC) Microsoft Endpoint Mapper (<a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-rpce/1644e4e6-1340-4d9a-9258-c62ff87e9e55#gt_f0c09805-df1e-4cdb-a71c-f0db94e870ae:~:text=endpoint%20mapper%3A%20A%20service%20on%20a%20remote%20procedure%20call%20(RPC)%20server%20that%20maintains%20a%20database%20of%20dynamic%20endpoints%20and%20allows%20clients%20to%20map%20an%20interface/object%20UUID%20pair%20to%20a%20local%20dynamic%20endpoint.%20For%20more%20information%2C%20see%20%5BC706%5D.">EPM</a>), которому соответствует UUID <em>e1af8308-5d1f-11c9-91a4-08002b14a0fa</em>. <br/>EPM <em>–</em> это служба, сопоставляющая требуемому приложению динамический порт RPC.</p><p>Служба EPM возвращает клиенту номер динамического RPC порта, в нашем случае 49666, так как на нем работает <em>DRSUAPI</em>. После чего происходит подключение к нему и следующим этапом идет вызов RPC функций <em>DRSUAPI</em> . Ниже на рисунках 23 и 24 показаны примеры этих событий, отражающих вызов RPC функций.</p><figure class=""><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/432/9f1/933/4329f1933451389e5b3a2380e2254039.png" alt="Рисунок 23 - Вызов функции DRSBind" title="Рисунок 23 - Вызов функции DRSBind" width="auto" height="auto" data-src="https://habrastorage.org/getpro/habr/upload_files/432/9f1/933/4329f1933451389e5b3a2380e2254039.png"/><figcaption>Рисунок 23 - Вызов функции DRSBind</figcaption></figure><figure class=""><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/387/a38/373/387a383731f1912660dc974f0f079b9b.png" alt="Рисунок 24 - Вызов функции DRSDomainControllerInfo" title="Рисунок 24 - Вызов функции DRSDomainControllerInfo" width="auto" height="auto" data-src="https://habrastorage.org/getpro/habr/upload_files/387/a38/373/387a383731f1912660dc974f0f079b9b.png"/><figcaption>Рисунок 24 - Вызов функции DRSDomainControllerInfo</figcaption></figure><p>Остальные логи выглядят идентично, только меняется <em>ProcNum</em> / <em>OpNum</em> в зависимости от вызываемой функции (метода), а общий порядок совпадает с представленным в трафике для каждой конкретной утилиты. В качестве примера представлен трафик mimikatz, под спойлером, из первой части статьи.</p><details class="spoiler"><summary>Трафик при DCSync</summary><div class="spoiler__content"><figure class=""><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/474/2a1/4aa/4742a14aa52ac0c66aa287ac3c9ca250.png" alt="Рисунок 25 - Трафик при DCSync с помощью mimikatz" title="Рисунок 25 - Трафик при DCSync с помощью mimikatz" width="auto" height="auto" data-src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/474/2a1/4aa/4742a14aa52ac0c66aa287ac3c9ca250.png"/><figcaption>Рисунок 25 - Трафик при DCSync с помощью mimikatz</figcaption></figure><p></p></div></details><p>К сожалению, лог RPC, отлеживаемый с помощью ETW, относится к событиям для отладки. Также количество RPC вызовов очень велико, и, как следствие, мы получаем большой поток достаточно сложно обрабатываемых событий. Дополнительно отмечу, что с помощью ETW событий хоть и можно отследить, какие конкретно функции, связанные с репликацией в домене, вызываются и в каком порядке, но нельзя определить сам источник вызова. Поэтому ETW точно не стоит рассматривать как самостоятельный источник информации.</p><p>Возможно данные проблемы можно решить с помощью событий из журнала Windows Security, поэтому предлагаю перейти к его анализу и посмотреть, какие логи можно получить при проведении атаки.</p><h2>Анализ Windows Security</h2><p>Для всех рассмотренных нами утилит на стороне контроллера домена формируются идентичные события  в журналах Windows. Так, например, на контроллере домена фиксируется событие <a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4662">4662</a>. Оно формируется, когда над объектом была выполнена какая-либо операция.</p><details class="spoiler"><summary>Включение создания событий для Audit Directory Service Access</summary><div class="spoiler__content"><p><em>Audit Directory Service Access</em> (Аудит доступа к службам каталогов). Настройка происходит в групповой политике - <em>Computer configurations > Policies > Windows Settings > Security Settings > Local Policies > Audit Policy > Audit Directory Service Access > Enable Success</em>. При настройке этого параметра в журналах будут генерироваться два новых идентификатора события: 4661 и 4662.</p></div></details><p>В событии 4662 нас интересуют такие поля, как <em>Subject Account Name</em> (<em>SubjectUserName</em>), <a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4662"><em>AccessMask</em></a> и <em>Properties</em>. В легитимном случае <em>Subject Account Name</em> должно содержать имя учетной записи контроллера домена или <em>NT AUTHORITY/SYSTEM</em>. Ниже приведен пример 4662 при легитимной репликации между контроллерами домена. Стоит отметить, что формирования данного события необходимо дополнительно настраивать <a href="https://learn.microsoft.com/en-us/windows/win32/secauthz/sacl-access-right">SACL</a> для группы <em>Domain Controllers</em>, об этом будет сказано далее.</p><figure class=""><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/ff6/369/ed9/ff6369ed9b8be2e585b2c3586e5f8607.png" alt="Рисунок 26 - Пример события 4662 при легитимной репликации между контроллерами домена" title="Рисунок 26 - Пример события 4662 при легитимной репликации между контроллерами домена" width="auto" height="auto" data-src="https://habrastorage.org/getpro/habr/upload_files/ff6/369/ed9/ff6369ed9b8be2e585b2c3586e5f8607.png"/><figcaption>Рисунок 26 - Пример события 4662 при легитимной репликации между контроллерами домена</figcaption></figure><p><br/><em>AccessMask</em> должна принимать <em>0x100</em> (<em>Control Access</em>): данное значение отражает, когда субъекту (пользователю, учетной записи) разрешается выполнение операции (репликации) над объектом (domainDNS). Операция репликации контролируется расширенным правом доступа, которое идентифицируется с помощью GUID. Их GUID были представлены в разделе <em>"Права доступа для выполнения репликации"</em>.<br/><br/>Как мы видим поле <em>Properties</em> состоит из двух частей:</p><ul><li><p><a href="https://gist.github.com/brianreitz/d5b9397a2e8b3d52ceb9359897e07c3f">Маска доступа</a> (%7688 - Control Access);</p></li></ul><ul><li><p>Тип доступа в GUID формате, связанный с репликацией, и класс объекта AD, представленный в виде GUID {19195a5b-6da0-11d0-afd3-00c04fd930c9}.</p></li></ul><p>Отличным признаком между тремя событиями ниже является поле Properties,  которое разные GUID'ы, отражающие соответствующие права доступа.  </p><figure class=""><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/305/b01/539/305b01539c346e40c6831c95d566265b.png" alt="Рисунок 27 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes" title="Рисунок 27 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes" width="auto" height="auto" data-src="https://habrastorage.org/getpro/habr/upload_files/305/b01/539/305b01539c346e40c6831c95d566265b.png"/><figcaption>Рисунок 27 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes</figcaption></figure><figure class=""><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/baa/26d/bd7/baa26dbd7414168fae81ea22cf15b288.png" alt="Рисунок 28 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes In Filtered Set" title="Рисунок 28 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes In Filtered Set" width="auto" height="auto" data-src="https://habrastorage.org/getpro/habr/upload_files/baa/26d/bd7/baa26dbd7414168fae81ea22cf15b288.png"/><figcaption>Рисунок 28 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes In Filtered Set</figcaption></figure><figure class=""><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/13a/965/92b/13a96592bb09fdc120cf75b03e9ebcc1.png" alt="Рисунок 29 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes All" title="Рисунок 29 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes All" width="auto" height="auto" data-src="https://habrastorage.org/getpro/habr/upload_files/13a/965/92b/13a96592bb09fdc120cf75b03e9ebcc1.png"/><figcaption>Рисунок 29 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes All</figcaption></figure><p>Если субъект не обладает требуемыми расширенными правами, то при попытке проведения атаки событие 4662 не регистрируется в журнале событий Windows Security.</p><details class="spoiler"><summary>SACL для формирования события 4662</summary><div class="spoiler__content"><p>Событие 4662 формируется после вызова функции <em>DsGetNCChanges</em>  из-за выставленного SACL. Посмотреть и выставить SACL можно в оснастке  там же, где и предоставляются права доступа. Также дополнительно нужно  перейти на вкладку <em>Advanced</em>. На рисунке 30 представлен SACL по умолчанию.  </p><figure class=""><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/a86/f85/511/a86f8551141d86e6e0f2cbd16a10e532.png" alt="Рисунок 30 - SACL по умолчанию " title="Рисунок 30 - SACL по умолчанию " width="auto" height="auto" data-src="https://habrastorage.org/getpro/habr/upload_files/a86/f85/511/a86f8551141d86e6e0f2cbd16a10e532.png"/><figcaption>Рисунок 30 - SACL по умолчанию </figcaption></figure><p></p></div></details><p>Дополнительно для получения информации об источнике атаки можно использовать событие <a href="https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-4624">4624</a> (<em>An account was successfully logged on</em>) или <a href="https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-5156">5156</a> (<em>The Windows Filtering Platform has permitted a connection</em>).</p><details class="spoiler"><summary>Примеры событий 4624 и 5156</summary><div class="spoiler__content"><figure class=""><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/0d7/098/db3/0d7098db3a648261695be50fc51ec3e3.png" alt="Рисунок 31 - Пример события 4624" title="Рисунок 31 - Пример события 4624" width="auto" height="auto" data-src="https://habrastorage.org/getpro/habr/upload_files/0d7/098/db3/0d7098db3a648261695be50fc51ec3e3.png"/><figcaption>Рисунок 31 - Пример события 4624</figcaption></figure><figure class=""><img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/8fe/377/df8/8fe377df8c142358ceae1455f240b59e.png" alt="Рисунок 32 - Пример события 5156" title="Рисунок 32 - Пример события 5156" width="auto" height="auto" data-src="https://habrastorage.org/getpro/habr/upload_files/8fe/377/df8/8fe377df8c142358ceae1455f240b59e.png"/><figcaption>Рисунок 32 - Пример события 5156</figcaption></figure><p></p></div></details><p><strong>Подведем итоги:</strong> в журналах Windows отображается одинаковые логи с одинаковыми значениями в ключевых полях <em>AccessMask и Properties</em>, что дает нам возможность построить наиболее универсальный вариант детектирования.</p><p>Разобравшись в механизмах проведения атаки, а также собрав информацию по работе утилит, перейдем к самому главному <em>–</em> к подготовке возможного детекта.</p><h2>Детектирование атаки</h2><p>Далее мы рассмотрим два варианта детектирования: на основе трафика и на основании событий Windows.</p><h3>Детектирование на основе трафика</h3><p>Конечно же атаку DCSync легче задетектировать, если мониторить сетевой трафик и вызов RPC функций. Для детекта нам нужно фиксировать информацию о наличии сразу двух функций <em>DRSReplicaSync</em> и <em>DRSGetNCChanges</em>. Если процедура репликации начинается с функции <em>DRSReplicaSync</em>, то данная ситуация с большей долей вероятности будет выглядеть как легитимная, в противном случае вызова функции <em>DRSGetNCChanges</em> без <em>DRSReplicaSync</em> будет говорить о проведении атаки.</p><p>Чтобы этот метод обнаружения был эффективным, необходимо, чтобы сеть была логически сегментирована, то есть контроллеры домена должны быть сгруппированы в отдельный сетевой сегмент. В этой конфигурации также могут быть реализованы превентивные меры для блокировки трафика DRSR, направляемый за пределы сегмента сети КД.</p><p>Обнаружение атаки DCSync на сетевом уровне путем идентификации трафика DCE/RPC, включающий вызовы интерфейса RPC DRSUAPI, осуществляется обычно с помощью IDS/IPS решений. Данный способ является наиболее простым для детектирования этого типа атак.</p><h3>Детект на основе Security журнала Windows</h3><p>Как уже было сказано, для возможного варианта детекта можно использовать событие 4662. Ниже мы видим разработанное псевдо-правило:</p><pre><code>(
	EventCode=4662 &amp;&amp;
	Access_Mask=0x100 &amp;&amp;
	Account_Name!="*$" &amp;&amp;
	Object_Type="%{19195a5b-6da0-11d0-afd3-00c04fd930c9}" &amp;&amp;
	(
		# Replicating Directory Changes
		Properties="*{1131f6aa-9c07–11d1-f79f-00c04fc2dcd2}*" ||
		# Replicating Directory Changes All
		Properties="*{1131f6ad-9c07-11d1-f79f-00c04fc2dcd2}*" ||
		# Replicating Directory Changes In Filtered Set (Optional)
		Properties="*{89e95b76-444d-4c62-991a-0facbeda640c}*" ||
	) 
)
</code></pre><p>В данном правиле предлагается отслеживать события 4662, у которых <em>AccessMask</em> равна <em>0x100</em> (<em>Control Access</em>) в комбинации с расширенными правами доступа на проведение репликации: <em>Replicating Directory Changes</em>, <em>Replicating Directory Changes All</em> и <em>Replicating Directory Changes In Filtered Set</em>. Для снижения ложно-положительных сработок при включенном SACL для учетных записей устройств, рекомендуется отбрасывать события, где в качестве субъекта используется учетная запись компьютера, то есть оканчивающаяся на знак <code>$</code>.</p><p>Для получения дополнительной информации по атаке можно использовать события <a href="https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-4624">4624</a> (<em>An account was successfully logged on</em>) или <a href="https://learn.microsoft.com/ru-ru/windows/security/threat-protection/auditing/event-5156">5156</a> (<em>The Windows Filtering Platform has permitted a connection</em>). На мой взгляд, удобнее использовать 4624, так как можно провести корреляцию по полю Logon ID с событием 4662.</p><p>Не обошлось и без ложки дегтя: cобытий 4662 может быть очень много, поскольку они генерируется при любых попытках доступа к объектам, для которых был настроен SACL. Дополнительно под данное событие попадают обращения к пространству имен <em>WMI</em> и <em>MicrosoftVolumeEncryption</em> (BitLocker). Многие процессы скрыто используют <em>WMI</em>. Поэтому их аудит по умолчанию отключен со стороны Microsoft.</p><p>У данного варианта детектирования DCSync на основе Security журнала, безусловно, есть свои минусы:</p><ul><li><p>детектирование постфактум;</p></li><li><p>большое количество событий на КД, что создает сложности в хранении и обработке логов.</p></li></ul><h2>Заключение</h2><p>В этой статье мы рассмотрели возможные способы детектирования DCSync и пришли к выводу, что атаку лучше всего детектировать с помощью трафика. При этом для упрощения успешного построения детекта корпоративная сеть должна быть сегментирована, а КД находиться в отдельном сегменте сети. Этот фактор позволит отбросить ложные срабатывания, а на уровне сети поможет определить, что запрос репликации исходит не от контроллера домена. При этом детектирования на основании журналов Windows также возможно, но зачастую будет содержать заметно большее число ложных срабатываний.<br/><br/>Надеюсь данная статья оказалась для вас полезной! Если у вас появились вопросы, пишите в комментариях!  </p><p><em>Автор: Кожушок Диана (<span>@wildresearcher</span>), аналитик-исследователь киберугроз в компании R-Vision</em></p><p></p></div></div></div> <!----> <!----></div> <!----> <!----></div> <!----> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D1%82%D0%B0%D0%BA%D0%B0%5D" class="tm-tags-list__link">атака</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bdcsync%5D" class="tm-tags-list__link">dcsync</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B4%D0%B5%D1%82%D0%B5%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%5D" class="tm-tags-list__link">детектирование</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B2%D1%8B%D1%8F%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%B0%D1%82%D0%B0%D0%BA%5D" class="tm-tags-list__link">выявление атак</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BE%D0%B1%D0%BD%D0%B0%D1%80%D1%83%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%B0%D1%82%D0%B0%D0%BA%D0%B8%5D" class="tm-tags-list__link">обнаружение атаки</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bdetect%5D" class="tm-tags-list__link">detect</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B2%D1%8B%D0%B7%D0%BE%D0%B2%20%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%B8%5D" class="tm-tags-list__link">вызов функции</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%81%D0%BE%D0%B1%D1%8B%D1%82%D0%B8%D1%8F%20%D0%B6%D1%83%D1%80%D0%BD%D0%B0%D0%BB%D0%B0%5D" class="tm-tags-list__link">события журнала</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7%20%D1%81%D0%BE%D0%B1%D1%8B%D1%82%D0%B8%D0%B9%5D" class="tm-tags-list__link">анализ событий</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/company/rvision/blog/" class="tm-hubs-list__link router-link-active">Блог компании R-Vision</a></li><li class="tm-separated-list__item"><a href="/ru/hub/infosecurity/" class="tm-hubs-list__link">Информационная безопасность</a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article"><title>Всего голосов 4: ↑4 и ↓0</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#counter-rating"></use></svg> <span title="Всего голосов 4: ↑4 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating">+4</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    10
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/rvision/blog/709942/comments/" class="tm-article-comments-counter-link__link"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      5
    </span></a> <!----></div> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="tm-sharing__icon"><path fill="currentColor" d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z"></path></svg></button> <DIV class="v-portal" style="display:none;"></DIV></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <DIV class="v-portal" style="display:none;"></DIV> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <div></div> <section class="tm-block tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"><div class="tm-article-author__company"><div class="tm-article-author__company-card"><div class="tm-company-snippet"><a href="/ru/company/rvision/profile/" class="tm-company-snippet__logo-link"><div class="tm-entity-image"><img alt="" height="40" src="//habrastorage.org/getpro/habr/company/9bc/04c/e86/9bc04ce8696b66f2315dafe9a35ce5b8.jpg" width="40" class="tm-entity-image__pic"></div></a> <div class="tm-company-snippet__info"><a href="/ru/company/rvision/profile/" class="tm-company-snippet__title">R-Vision</a> <div class="tm-company-snippet__description">Разработчик систем кибербезопасности</div></div></div> <div class="tm-article-author__buttons"><!----> <!----></div></div> <div class="tm-article-author__company-contacts"><a href="http://rvision.ru" rel="noopener" target="_blank" class="tm-article-author__contact">
      Сайт
    </a></div> <div class="tm-article-author__separator"></div></div> <div class="tm-user-card tm-article-author__user-card tm-user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/rvteam/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/c9f/0ee/0a8/c9f0ee0a875a62b1f2b52cd61166ffe5.jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 28 голосов " class="tm-counter-container tm-karma tm-karma"><div class="tm-counter-container__header"><div class="tm-karma__votes tm-karma__votes_positive">
      16
    </div></div> <div class="tm-counter-container__footer"><div class="tm-karma__text">
      Карма
    </div> <DIV class="v-portal" style="display:none;"></DIV></div></div> <div title="Рейтинг пользователя" class="tm-counter-container"><div class="tm-counter-container__header"> <div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating"><!----> <div class="tm-votes-lever__score tm-votes-lever__score tm-votes-lever__score_appearance-rating"><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter tm-votes-lever__score-counter_rating">
        3
      </span></div> <!----></div></div> <div class="tm-counter-container__footer"><span class="tm-rating__text tm-rating__text">
      Рейтинг
    </span></div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title tm-user-card__title_variant-article"><!----> <a href="/ru/users/rvteam/" class="tm-user-card__nickname tm-user-card__nickname tm-user-card__nickname_variant-article">
          @rvteam
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info tm-user-card__short-info_variant-article">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <!----> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/company/rvision/blog/709942/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 5 
    </span></a> <!----></div></div></div>  <section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header tm-block__header_variant-borderless"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title tm-block__title_variant-large">Публикации</h2> </div> <!----></header> <div class="tm-block__body tm-block__body tm-block__body_variant-condensed-slim"><div class="tm-tabs tm-tabs"><div><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_active tm-tabs__tab-link_slim">
        Лучшие за сутки
      </button></span><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_slim">
        Похожие
      </button></span></div> <!----></div> <div class="similar-and-daily__tab-view"><div><!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <div class="tm-placeholder-article-cards"><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div></div> <!----> <!----> <!----> <!----></div> <!----></div></div> <!----></section> <div><!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <div class="tm-placeholder-inset tm-placeholder-vacancies"><div class="tm-placeholder-inset__header"><div class="tm-placeholder__line tm-placeholder__line_inset-header loads"></div></div> <div class="tm-placeholder-inset__body"><ul class="tm-placeholder-list"><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li></ul></div> <div class="tm-placeholder-inset__footer"><div class="tm-placeholder__line tm-placeholder__line_inset-footer loads"></div></div></div> <!----> <!----> <!----> <!----> <!----> <!----></div> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__placeholder_initial"></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">Информация</h2> </div> <!----></header> <div class="tm-block__body tm-block__body"><div class="tm-company-basic-info"><dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title tm-description-list__title_variant-columns-nowrap">Сайт</dt> <dd class="tm-description-list__body tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="http://rvision.ru" target="_blank" class="tm-company-basic-info__link">
      rvision.ru
    </a></dd></dl> <dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата регистрации</dt> <dd class="tm-description-list__body tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="2021-04-14T10:05:18.000Z" title="2021-04-14, 13:05">14  апреля  2021</time></dd></dl> <dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата основания</dt> <dd class="tm-description-list__body tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="2011-07-07T20:00:00.000Z" title="2011-07-08, 00:00">8  июля  2011</time></dd></dl> <dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title tm-description-list__title_variant-columns-nowrap">Численность</dt> <dd class="tm-description-list__body tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    201–500 человек
  </dd></dl> <dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title tm-description-list__title_variant-columns-nowrap">Местоположение</dt> <dd class="tm-description-list__body tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    Россия
  </dd></dl> <!----></div></div> <!----></section> <div class="tm-company-widgets"></div> <!----> <!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Ваш аккаунт
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/company/rvision/blog/709942/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/company/rvision/blog/709942/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Разделы
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Информация
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Услуги
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/corporate-blogs/" target="_blank">
                Корпоративный блог
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/advertising/" target="_blank">
                Медийная реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/native-special/" target="_blank">
                Нативные проекты
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/education-programs/" target="_blank">
                Образовательные программы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/hello-startup/" target="_blank">
                Стартапам
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2023, </span> <span class="tm-copyright__name"><a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a></span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"709942":{"id":"709942","timePublished":"2023-01-19T09:07:46+00:00","isCorporative":true,"lang":"ru","titleHtml":"DCSync: особенности выполнения атаки и возможные варианты детектирования, Часть 2","leadData":{"textHtml":"\u003Cp\u003EПривет, Хабр!\u003C\u002Fp\u003E\u003Cp\u003EВ \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Frvision\u002Fblog\u002F709866\u002F\"\u003Eпредущей статье \u003C\u002Fa\u003Eмы  разобрали основы и механизмы работы атаки DCSync, а также рассмотрели  несколько наиболее популярных утилит для ее реализации: \u003Cstrong\u003Emimikatz, secretsdump, DSInternals \u003C\u002Fstrong\u003Eи\u003Cstrong\u003E \u003C\u002Fstrong\u003Eсуществующие  между ними различия. В результате анализа стало понятно, что у всех  утилит прослеживается один и тот же принцип проведения атаки и  присутствует одинаковый фактор для ее выявления - \u003Cem\u003EDRSReplicaSync\u003C\u002Fem\u003E. \u003C\u002Fp\u003E\u003Cp\u003EВ этой части я сфокусируюсь на потенциальных способах детектирования DCSync. \u003Cbr\u003EДля  построения возможной логики детектирования для начала нам необходимо  изучить какие события в журналах Windows и на уровне мы можем  зафиксировать в результате запуска утилит. \u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa08\u002Fe80\u002F15b\u002Fa08e8015bcb9d00ed752ececdd6ba736.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa08\u002Fe80\u002F15b\u002Fa08e8015bcb9d00ed752ececdd6ba736.jpg","fit":"cover","positionY":0,"positionX":0}},"editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2615597","alias":"rvteam","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fc9f\u002F0ee\u002F0a8\u002Fc9f0ee0a875a62b1f2b52cd61166ffe5.jpg","speciality":"Пользователь","scoreStats":{"score":16,"votesCount":28},"rating":3,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null}},"statistics":{"commentsCount":5,"favoritesCount":10,"readingCount":1225,"score":4,"votesCount":4,"votesCountPlus":4,"votesCountMinus":0},"hubs":[{"id":"22716","alias":"rvision","type":"corporative","title":"Блог компании R-Vision","titleHtml":"Блог компании R-Vision","isProfiled":false,"relatedData":null},{"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true,"relatedData":null}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3b8\u002F6b1\u002Fe83\u002F3b86b1e839a172bc80303d38d0b2bca8.jpg\" width=\"2560\" height=\"1709\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3b8\u002F6b1\u002Fe83\u002F3b86b1e839a172bc80303d38d0b2bca8.jpg\" data-blurred=\"true\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EПривет, Хабр! В \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Frvision\u002Fblog\u002F709866\u002F\"\u003Eпредыдущей статье \u003C\u002Fa\u003Eмы разобрали основы и механизмы работы атаки DCSync, а также рассмотрели несколько наиболее популярных утилит для ее реализации: \u003Cstrong\u003Emimikatz, secretsdump, DSInternals \u003C\u002Fstrong\u003Eи\u003Cstrong\u003E \u003C\u002Fstrong\u003Eсуществующие между ними отличия. В результате мы обнаружили, что у всех утилит прослеживается один и тот же принцип проведения атаки и присутствует одинаковый фактор для ее выявления \u003Cem\u003E–\u003C\u002Fem\u003E \u003Cem\u003EDRSReplicaSync\u003C\u002Fem\u003E. \u003C\u002Fp\u003E\u003Cp\u003EВ этой части мы сфокусируемся на возможных способах детектирования атаки DCSync. \u003Cbr\u002F\u003EДля построения возможной логики выявления атаки сперва нам необходимо изучить какие события и в каких журналах мы можем увидеть в результате запуска утилит, которые впоследствие могут лечь в основу детекта. Давайте приступим.\u003C\u002Fp\u003E\u003Ch2\u003EАнализ событий RPC\u003C\u002Fh2\u003E\u003Cp\u003EРанее, при разборе кодовой базы утилит мы увидели, что при репликации данных используются вызовы RPC функций. Вызов RPC функций можно отследить с помощью технологии \u003Ca href=\"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fwindows-hardware\u002Ftest\u002Fwpt\u002Fevent-tracing-for-windows\"\u003EEvent Tracing for Windows\u003C\u002Fa\u003E (ETW) и её провайдера \u003Cem\u003EMicrosoft-Windows-RPC\u003C\u002Fem\u003E. \u003Cbr\u002F\u003ERPC функции однозначно идентифицируются по номеру интерфейса, его \u003Cem\u003EUUID\u003C\u002Fem\u003E, и номеру операции - \u003Cem\u003Eopnum\u003C\u002Fem\u003E \u002F \u003Cem\u003Eprocmon\u003C\u002Fem\u003E. При этом номер интерфейса распознает группу связанных удаленных функций. Функциям \u003Cem\u003EDRSUAPI\u003C\u002Fem\u003E соответствует идентификатор UUID \u003Ca href=\"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fopenspecs\u002Fwindows_protocols\u002Fms-drsr\u002F063618ed-b2e2-4983-ab13-3ed056700641\"\u003E\u003Cem\u003Ee3514235-4b06-11d1-ab04-00c04fc2dcd2\u003C\u002Fem\u003E\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F32b\u002F368\u002F845\u002F32b36884590a465e74135611447766da.png\" alt=\"Рисунок 22 - Подключение к RPC EPM, расположенному на порту 135\" title=\"Рисунок 22 - Подключение к RPC EPM, расположенному на порту 135\" width=\"auto\" height=\"auto\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F32b\u002F368\u002F845\u002F32b36884590a465e74135611447766da.png\"\u002F\u003E\u003Cfigcaption\u003EРисунок 22 - Подключение к RPC EPM, расположенному на порту 135\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EКак видно из полученных логов (рисунок 22), на первом этапе происходит подключение клиента по порту 135 к протоколу удаленного вызова процедур (RPC) Microsoft Endpoint Mapper (\u003Ca href=\"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fopenspecs\u002Fwindows_protocols\u002Fms-rpce\u002F1644e4e6-1340-4d9a-9258-c62ff87e9e55#gt_f0c09805-df1e-4cdb-a71c-f0db94e870ae:~:text=endpoint%20mapper%3A%20A%20service%20on%20a%20remote%20procedure%20call%20(RPC)%20server%20that%20maintains%20a%20database%20of%20dynamic%20endpoints%20and%20allows%20clients%20to%20map%20an%20interface\u002Fobject%20UUID%20pair%20to%20a%20local%20dynamic%20endpoint.%20For%20more%20information%2C%20see%20%5BC706%5D.\"\u003EEPM\u003C\u002Fa\u003E), которому соответствует UUID \u003Cem\u003Ee1af8308-5d1f-11c9-91a4-08002b14a0fa\u003C\u002Fem\u003E. \u003Cbr\u002F\u003EEPM \u003Cem\u003E–\u003C\u002Fem\u003E это служба, сопоставляющая требуемому приложению динамический порт RPC.\u003C\u002Fp\u003E\u003Cp\u003EСлужба EPM возвращает клиенту номер динамического RPC порта, в нашем случае 49666, так как на нем работает \u003Cem\u003EDRSUAPI\u003C\u002Fem\u003E. После чего происходит подключение к нему и следующим этапом идет вызов RPC функций \u003Cem\u003EDRSUAPI\u003C\u002Fem\u003E . Ниже на рисунках 23 и 24 показаны примеры этих событий, отражающих вызов RPC функций.\u003C\u002Fp\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F432\u002F9f1\u002F933\u002F4329f1933451389e5b3a2380e2254039.png\" alt=\"Рисунок 23 - Вызов функции DRSBind\" title=\"Рисунок 23 - Вызов функции DRSBind\" width=\"auto\" height=\"auto\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F432\u002F9f1\u002F933\u002F4329f1933451389e5b3a2380e2254039.png\"\u002F\u003E\u003Cfigcaption\u003EРисунок 23 - Вызов функции DRSBind\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F387\u002Fa38\u002F373\u002F387a383731f1912660dc974f0f079b9b.png\" alt=\"Рисунок 24 - Вызов функции DRSDomainControllerInfo\" title=\"Рисунок 24 - Вызов функции DRSDomainControllerInfo\" width=\"auto\" height=\"auto\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F387\u002Fa38\u002F373\u002F387a383731f1912660dc974f0f079b9b.png\"\u002F\u003E\u003Cfigcaption\u003EРисунок 24 - Вызов функции DRSDomainControllerInfo\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EОстальные логи выглядят идентично, только меняется \u003Cem\u003EProcNum\u003C\u002Fem\u003E \u002F \u003Cem\u003EOpNum\u003C\u002Fem\u003E в зависимости от вызываемой функции (метода), а общий порядок совпадает с представленным в трафике для каждой конкретной утилиты. В качестве примера представлен трафик mimikatz, под спойлером, из первой части статьи.\u003C\u002Fp\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003EТрафик при DCSync\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F474\u002F2a1\u002F4aa\u002F4742a14aa52ac0c66aa287ac3c9ca250.png\" alt=\"Рисунок 25 - Трафик при DCSync с помощью mimikatz\" title=\"Рисунок 25 - Трафик при DCSync с помощью mimikatz\" width=\"auto\" height=\"auto\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F474\u002F2a1\u002F4aa\u002F4742a14aa52ac0c66aa287ac3c9ca250.png\"\u002F\u003E\u003Cfigcaption\u003EРисунок 25 - Трафик при DCSync с помощью mimikatz\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003Cp\u003EК сожалению, лог RPC, отлеживаемый с помощью ETW, относится к событиям для отладки. Также количество RPC вызовов очень велико, и, как следствие, мы получаем большой поток достаточно сложно обрабатываемых событий. Дополнительно отмечу, что с помощью ETW событий хоть и можно отследить, какие конкретно функции, связанные с репликацией в домене, вызываются и в каком порядке, но нельзя определить сам источник вызова. Поэтому ETW точно не стоит рассматривать как самостоятельный источник информации.\u003C\u002Fp\u003E\u003Cp\u003EВозможно данные проблемы можно решить с помощью событий из журнала Windows Security, поэтому предлагаю перейти к его анализу и посмотреть, какие логи можно получить при проведении атаки.\u003C\u002Fp\u003E\u003Ch2\u003EАнализ Windows Security\u003C\u002Fh2\u003E\u003Cp\u003EДля всех рассмотренных нами утилит на стороне контроллера домена формируются идентичные события  в журналах Windows. Так, например, на контроллере домена фиксируется событие \u003Ca href=\"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fwindows\u002Fsecurity\u002Fthreat-protection\u002Fauditing\u002Fevent-4662\"\u003E4662\u003C\u002Fa\u003E. Оно формируется, когда над объектом была выполнена какая-либо операция.\u003C\u002Fp\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003EВключение создания событий для Audit Directory Service Access\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Cp\u003E\u003Cem\u003EAudit Directory Service Access\u003C\u002Fem\u003E (Аудит доступа к службам каталогов). Настройка происходит в групповой политике - \u003Cem\u003EComputer configurations \u003E Policies \u003E Windows Settings \u003E Security Settings \u003E Local Policies \u003E Audit Policy \u003E Audit Directory Service Access \u003E Enable Success\u003C\u002Fem\u003E. При настройке этого параметра в журналах будут генерироваться два новых идентификатора события: 4661 и 4662.\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003Cp\u003EВ событии 4662 нас интересуют такие поля, как \u003Cem\u003ESubject Account Name\u003C\u002Fem\u003E (\u003Cem\u003ESubjectUserName\u003C\u002Fem\u003E), \u003Ca href=\"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fwindows\u002Fsecurity\u002Fthreat-protection\u002Fauditing\u002Fevent-4662\"\u003E\u003Cem\u003EAccessMask\u003C\u002Fem\u003E\u003C\u002Fa\u003E и \u003Cem\u003EProperties\u003C\u002Fem\u003E. В легитимном случае \u003Cem\u003ESubject Account Name\u003C\u002Fem\u003E должно содержать имя учетной записи контроллера домена или \u003Cem\u003ENT AUTHORITY\u002FSYSTEM\u003C\u002Fem\u003E. Ниже приведен пример 4662 при легитимной репликации между контроллерами домена. Стоит отметить, что формирования данного события необходимо дополнительно настраивать \u003Ca href=\"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fwindows\u002Fwin32\u002Fsecauthz\u002Fsacl-access-right\"\u003ESACL\u003C\u002Fa\u003E для группы \u003Cem\u003EDomain Controllers\u003C\u002Fem\u003E, об этом будет сказано далее.\u003C\u002Fp\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fff6\u002F369\u002Fed9\u002Fff6369ed9b8be2e585b2c3586e5f8607.png\" alt=\"Рисунок 26 - Пример события 4662 при легитимной репликации между контроллерами домена\" title=\"Рисунок 26 - Пример события 4662 при легитимной репликации между контроллерами домена\" width=\"auto\" height=\"auto\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fff6\u002F369\u002Fed9\u002Fff6369ed9b8be2e585b2c3586e5f8607.png\"\u002F\u003E\u003Cfigcaption\u003EРисунок 26 - Пример события 4662 при легитимной репликации между контроллерами домена\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003Cbr\u002F\u003E\u003Cem\u003EAccessMask\u003C\u002Fem\u003E должна принимать \u003Cem\u003E0x100\u003C\u002Fem\u003E (\u003Cem\u003EControl Access\u003C\u002Fem\u003E): данное значение отражает, когда субъекту (пользователю, учетной записи) разрешается выполнение операции (репликации) над объектом (domainDNS). Операция репликации контролируется расширенным правом доступа, которое идентифицируется с помощью GUID. Их GUID были представлены в разделе \u003Cem\u003E\"Права доступа для выполнения репликации\"\u003C\u002Fem\u003E.\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EКак мы видим поле \u003Cem\u003EProperties\u003C\u002Fem\u003E состоит из двух частей:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgist.github.com\u002Fbrianreitz\u002Fd5b9397a2e8b3d52ceb9359897e07c3f\"\u003EМаска доступа\u003C\u002Fa\u003E (%7688 - Control Access);\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EТип доступа в GUID формате, связанный с репликацией, и класс объекта AD, представленный в виде GUID {19195a5b-6da0-11d0-afd3-00c04fd930c9}.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EОтличным признаком между тремя событиями ниже является поле Properties,  которое разные GUID'ы, отражающие соответствующие права доступа.  \u003C\u002Fp\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F305\u002Fb01\u002F539\u002F305b01539c346e40c6831c95d566265b.png\" alt=\"Рисунок 27 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes\" title=\"Рисунок 27 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes\" width=\"auto\" height=\"auto\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F305\u002Fb01\u002F539\u002F305b01539c346e40c6831c95d566265b.png\"\u002F\u003E\u003Cfigcaption\u003EРисунок 27 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbaa\u002F26d\u002Fbd7\u002Fbaa26dbd7414168fae81ea22cf15b288.png\" alt=\"Рисунок 28 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes In Filtered Set\" title=\"Рисунок 28 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes In Filtered Set\" width=\"auto\" height=\"auto\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbaa\u002F26d\u002Fbd7\u002Fbaa26dbd7414168fae81ea22cf15b288.png\"\u002F\u003E\u003Cfigcaption\u003EРисунок 28 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes In Filtered Set\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F13a\u002F965\u002F92b\u002F13a96592bb09fdc120cf75b03e9ebcc1.png\" alt=\"Рисунок 29 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes All\" title=\"Рисунок 29 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes All\" width=\"auto\" height=\"auto\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F13a\u002F965\u002F92b\u002F13a96592bb09fdc120cf75b03e9ebcc1.png\"\u002F\u003E\u003Cfigcaption\u003EРисунок 29 - Пример события 4662: получение доступа к domainDNS с правом доступа Replicating Directory Changes All\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EЕсли субъект не обладает требуемыми расширенными правами, то при попытке проведения атаки событие 4662 не регистрируется в журнале событий Windows Security.\u003C\u002Fp\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003ESACL для формирования события 4662\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Cp\u003EСобытие 4662 формируется после вызова функции \u003Cem\u003EDsGetNCChanges\u003C\u002Fem\u003E  из-за выставленного SACL. Посмотреть и выставить SACL можно в оснастке  там же, где и предоставляются права доступа. Также дополнительно нужно  перейти на вкладку \u003Cem\u003EAdvanced\u003C\u002Fem\u003E. На рисунке 30 представлен SACL по умолчанию.  \u003C\u002Fp\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa86\u002Ff85\u002F511\u002Fa86f8551141d86e6e0f2cbd16a10e532.png\" alt=\"Рисунок 30 - SACL по умолчанию \" title=\"Рисунок 30 - SACL по умолчанию \" width=\"auto\" height=\"auto\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa86\u002Ff85\u002F511\u002Fa86f8551141d86e6e0f2cbd16a10e532.png\"\u002F\u003E\u003Cfigcaption\u003EРисунок 30 - SACL по умолчанию \u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003Cp\u003EДополнительно для получения информации об источнике атаки можно использовать событие \u003Ca href=\"https:\u002F\u002Flearn.microsoft.com\u002Fru-ru\u002Fwindows\u002Fsecurity\u002Fthreat-protection\u002Fauditing\u002Fevent-4624\"\u003E4624\u003C\u002Fa\u003E (\u003Cem\u003EAn account was successfully logged on\u003C\u002Fem\u003E) или \u003Ca href=\"https:\u002F\u002Flearn.microsoft.com\u002Fru-ru\u002Fwindows\u002Fsecurity\u002Fthreat-protection\u002Fauditing\u002Fevent-5156\"\u003E5156\u003C\u002Fa\u003E (\u003Cem\u003EThe Windows Filtering Platform has permitted a connection\u003C\u002Fem\u003E).\u003C\u002Fp\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003EПримеры событий 4624 и 5156\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0d7\u002F098\u002Fdb3\u002F0d7098db3a648261695be50fc51ec3e3.png\" alt=\"Рисунок 31 - Пример события 4624\" title=\"Рисунок 31 - Пример события 4624\" width=\"auto\" height=\"auto\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0d7\u002F098\u002Fdb3\u002F0d7098db3a648261695be50fc51ec3e3.png\"\u002F\u003E\u003Cfigcaption\u003EРисунок 31 - Пример события 4624\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8fe\u002F377\u002Fdf8\u002F8fe377df8c142358ceae1455f240b59e.png\" alt=\"Рисунок 32 - Пример события 5156\" title=\"Рисунок 32 - Пример события 5156\" width=\"auto\" height=\"auto\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8fe\u002F377\u002Fdf8\u002F8fe377df8c142358ceae1455f240b59e.png\"\u002F\u003E\u003Cfigcaption\u003EРисунок 32 - Пример события 5156\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003Cp\u003E\u003Cstrong\u003EПодведем итоги:\u003C\u002Fstrong\u003E в журналах Windows отображается одинаковые логи с одинаковыми значениями в ключевых полях \u003Cem\u003EAccessMask и Properties\u003C\u002Fem\u003E, что дает нам возможность построить наиболее универсальный вариант детектирования.\u003C\u002Fp\u003E\u003Cp\u003EРазобравшись в механизмах проведения атаки, а также собрав информацию по работе утилит, перейдем к самому главному \u003Cem\u003E–\u003C\u002Fem\u003E к подготовке возможного детекта.\u003C\u002Fp\u003E\u003Ch2\u003EДетектирование атаки\u003C\u002Fh2\u003E\u003Cp\u003EДалее мы рассмотрим два варианта детектирования: на основе трафика и на основании событий Windows.\u003C\u002Fp\u003E\u003Ch3\u003EДетектирование на основе трафика\u003C\u002Fh3\u003E\u003Cp\u003EКонечно же атаку DCSync легче задетектировать, если мониторить сетевой трафик и вызов RPC функций. Для детекта нам нужно фиксировать информацию о наличии сразу двух функций \u003Cem\u003EDRSReplicaSync\u003C\u002Fem\u003E и \u003Cem\u003EDRSGetNCChanges\u003C\u002Fem\u003E. Если процедура репликации начинается с функции \u003Cem\u003EDRSReplicaSync\u003C\u002Fem\u003E, то данная ситуация с большей долей вероятности будет выглядеть как легитимная, в противном случае вызова функции \u003Cem\u003EDRSGetNCChanges\u003C\u002Fem\u003E без \u003Cem\u003EDRSReplicaSync\u003C\u002Fem\u003E будет говорить о проведении атаки.\u003C\u002Fp\u003E\u003Cp\u003EЧтобы этот метод обнаружения был эффективным, необходимо, чтобы сеть была логически сегментирована, то есть контроллеры домена должны быть сгруппированы в отдельный сетевой сегмент. В этой конфигурации также могут быть реализованы превентивные меры для блокировки трафика DRSR, направляемый за пределы сегмента сети КД.\u003C\u002Fp\u003E\u003Cp\u003EОбнаружение атаки DCSync на сетевом уровне путем идентификации трафика DCE\u002FRPC, включающий вызовы интерфейса RPC DRSUAPI, осуществляется обычно с помощью IDS\u002FIPS решений. Данный способ является наиболее простым для детектирования этого типа атак.\u003C\u002Fp\u003E\u003Ch3\u003EДетект на основе Security журнала Windows\u003C\u002Fh3\u003E\u003Cp\u003EКак уже было сказано, для возможного варианта детекта можно использовать событие 4662. Ниже мы видим разработанное псевдо-правило:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E(\n\tEventCode=4662 &amp;&amp;\n\tAccess_Mask=0x100 &amp;&amp;\n\tAccount_Name!=\"*$\" &amp;&amp;\n\tObject_Type=\"%{19195a5b-6da0-11d0-afd3-00c04fd930c9}\" &amp;&amp;\n\t(\n\t\t# Replicating Directory Changes\n\t\tProperties=\"*{1131f6aa-9c07–11d1-f79f-00c04fc2dcd2}*\" ||\n\t\t# Replicating Directory Changes All\n\t\tProperties=\"*{1131f6ad-9c07-11d1-f79f-00c04fc2dcd2}*\" ||\n\t\t# Replicating Directory Changes In Filtered Set (Optional)\n\t\tProperties=\"*{89e95b76-444d-4c62-991a-0facbeda640c}*\" ||\n\t) \n)\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВ данном правиле предлагается отслеживать события 4662, у которых \u003Cem\u003EAccessMask\u003C\u002Fem\u003E равна \u003Cem\u003E0x100\u003C\u002Fem\u003E (\u003Cem\u003EControl Access\u003C\u002Fem\u003E) в комбинации с расширенными правами доступа на проведение репликации: \u003Cem\u003EReplicating Directory Changes\u003C\u002Fem\u003E, \u003Cem\u003EReplicating Directory Changes All\u003C\u002Fem\u003E и \u003Cem\u003EReplicating Directory Changes In Filtered Set\u003C\u002Fem\u003E. Для снижения ложно-положительных сработок при включенном SACL для учетных записей устройств, рекомендуется отбрасывать события, где в качестве субъекта используется учетная запись компьютера, то есть оканчивающаяся на знак \u003Ccode\u003E$\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cp\u003EДля получения дополнительной информации по атаке можно использовать события \u003Ca href=\"https:\u002F\u002Flearn.microsoft.com\u002Fru-ru\u002Fwindows\u002Fsecurity\u002Fthreat-protection\u002Fauditing\u002Fevent-4624\"\u003E4624\u003C\u002Fa\u003E (\u003Cem\u003EAn account was successfully logged on\u003C\u002Fem\u003E) или \u003Ca href=\"https:\u002F\u002Flearn.microsoft.com\u002Fru-ru\u002Fwindows\u002Fsecurity\u002Fthreat-protection\u002Fauditing\u002Fevent-5156\"\u003E5156\u003C\u002Fa\u003E (\u003Cem\u003EThe Windows Filtering Platform has permitted a connection\u003C\u002Fem\u003E). На мой взгляд, удобнее использовать 4624, так как можно провести корреляцию по полю Logon ID с событием 4662.\u003C\u002Fp\u003E\u003Cp\u003EНе обошлось и без ложки дегтя: cобытий 4662 может быть очень много, поскольку они генерируется при любых попытках доступа к объектам, для которых был настроен SACL. Дополнительно под данное событие попадают обращения к пространству имен \u003Cem\u003EWMI\u003C\u002Fem\u003E и \u003Cem\u003EMicrosoftVolumeEncryption\u003C\u002Fem\u003E (BitLocker). Многие процессы скрыто используют \u003Cem\u003EWMI\u003C\u002Fem\u003E. Поэтому их аудит по умолчанию отключен со стороны Microsoft.\u003C\u002Fp\u003E\u003Cp\u003EУ данного варианта детектирования DCSync на основе Security журнала, безусловно, есть свои минусы:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003Eдетектирование постфактум;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eбольшое количество событий на КД, что создает сложности в хранении и обработке логов.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch2\u003EЗаключение\u003C\u002Fh2\u003E\u003Cp\u003EВ этой статье мы рассмотрели возможные способы детектирования DCSync и пришли к выводу, что атаку лучше всего детектировать с помощью трафика. При этом для упрощения успешного построения детекта корпоративная сеть должна быть сегментирована, а КД находиться в отдельном сегменте сети. Этот фактор позволит отбросить ложные срабатывания, а на уровне сети поможет определить, что запрос репликации исходит не от контроллера домена. При этом детектирования на основании журналов Windows также возможно, но зачастую будет содержать заметно большее число ложных срабатываний.\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EНадеюсь данная статья оказалась для вас полезной! Если у вас появились вопросы, пишите в комментариях!  \u003C\u002Fp\u003E\u003Cp\u003E\u003Cem\u003EАвтор: Кожушок Диана (\u003Cspan\u003E@wildresearcher\u003C\u002Fspan\u003E), аналитик-исследователь киберугроз в компании R-Vision\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"атака"},{"titleHtml":"dcsync"},{"titleHtml":"детектирование"},{"titleHtml":"выявление атак"},{"titleHtml":"обнаружение атаки"},{"titleHtml":"detect"},{"titleHtml":"вызов функции"},{"titleHtml":"события журнала"},{"titleHtml":"анализ событий"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa08\u002Fe80\u002F15b\u002Fa08e8015bcb9d00ed752ececdd6ba736.jpg","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa08\u002Fe80\u002F15b\u002Fa08e8015bcb9d00ed752ececdd6ba736.jpg","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Frvision\\\u002Fblog\\\u002F709942\\\u002F\"},\"headline\":\"DCSync: особенности выполнения атаки и возможные варианты детектирования, Часть 2\",\"datePublished\":\"2023-01-19T12:07:46+03:00\",\"dateModified\":\"2023-01-19T13:42:15+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"rvteam\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Привет, Хабр! В предыдущей статье мы разобрали основы и механизмы работы атаки DCSync, а также рассмотрели несколько наиболее популярных утилит для ее реализации...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Frvision\\\u002Fblog\\\u002F709942\\\u002F#post-content-body\",\"about\":[\"c_rvision\",\"h_infosecurity\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F709942\\\u002F81b7a8c98e496fd7eb7e5f132503e954\\\u002F\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F3b8\\\u002F6b1\\\u002Fe83\\\u002F3b86b1e839a172bc80303d38d0b2bca8.jpg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F32b\\\u002F368\\\u002F845\\\u002F32b36884590a465e74135611447766da.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F432\\\u002F9f1\\\u002F933\\\u002F4329f1933451389e5b3a2380e2254039.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F387\\\u002Fa38\\\u002F373\\\u002F387a383731f1912660dc974f0f079b9b.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fr\\\u002Fw1560\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F474\\\u002F2a1\\\u002F4aa\\\u002F4742a14aa52ac0c66aa287ac3c9ca250.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fff6\\\u002F369\\\u002Fed9\\\u002Fff6369ed9b8be2e585b2c3586e5f8607.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F305\\\u002Fb01\\\u002F539\\\u002F305b01539c346e40c6831c95d566265b.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fbaa\\\u002F26d\\\u002Fbd7\\\u002Fbaa26dbd7414168fae81ea22cf15b288.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F13a\\\u002F965\\\u002F92b\\\u002F13a96592bb09fdc120cf75b03e9ebcc1.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fa86\\\u002Ff85\\\u002F511\\\u002Fa86f8551141d86e6e0f2cbd16a10e532.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F0d7\\\u002F098\\\u002Fdb3\\\u002F0d7098db3a648261695be50fc51ec3e3.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F8fe\\\u002F377\\\u002Fdf8\\\u002F8fe377df8c142358ceae1455f240b59e.png\"]}","metaDescription":"Привет, Хабр! В предыдущей статье мы разобрали основы и механизмы работы атаки DCSync, а также рассмотрели несколько наиболее популярных утилит для ее реализации: mimikatz, secretsdump, DSInternals и...","mainImageUrl":null,"amp":true,"customTrackerLinks":[]},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"hasPinnedComments":false,"format":"tutorial","readingTime":7,"complexity":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{"userReasonsList":null}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":""},"comments":{"articleComments":{},"articlePinnedComments":{},"searchCommentsResults":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{"rvision":{"alias":"rvision","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F9bc\u002F04c\u002Fe86\u002F9bc04ce8696b66f2315dafe9a35ce5b8.jpg","titleHtml":"R-Vision","descriptionHtml":"Разработчик систем кибербезопасности","relatedData":null,"statistics":{"subscribersCount":114,"rating":90.31,"invest":null,"postsCount":27,"newsCount":0,"vacanciesCount":5,"employeesCount":5,"careerRating":4.78},"foundationDate":{"year":"2011","month":"07","day":"08"},"location":{"city":{"id":"447159","title":"Москва"},"region":{"id":"1885","title":"Москва и Московская обл."},"country":{"id":"168","title":"Россия"}},"siteUrl":"http:\u002F\u002Frvision.ru","staffNumber":"201–500 человек","registrationDate":"2021-04-14T10:05:18+00:00","representativeUser":null,"contacts":[{"title":"Сайт","url":"http:\u002F\u002Frvision.ru","siteTitle":"R-Vision","favicon":"https:\u002F\u002Frvision.ru\u002Fdist\u002Fimg\u002Ffavicon\u002Ffavicon-32x32.png"}],"settings":{"analyticsSettings":[],"branding":null,"status":"active","isStartup":false},"metadata":{"titleHtml":"R-Vision, Москва - Разработчик систем кибербезопасности с 8 июля 2011 г.","title":"R-Vision, Москва - Разработчик систем кибербезопасности с 8 июля 2011 г.","keywords":["Информационная безопасность","Сетевые технологии","Реверс-инжиниринг","threat intelligence","digital forensics","атака","детектирование","информационная безопасность","apt","фишинг","malware","фишинговые атаки","кибератаки","rootkit","эмоциональное выгорание","самокоучинг","корпоративная сеть","хакерские атаки","сетевая безопасность","honeypot","сетевая инфраструктура","целевые атаки","направленные атаки"],"descriptionHtml":"27 статей от авторов компании R-Vision","description":"27 статей от авторов компании R-Vision"},"aDeskSettings":null,"careerAlias":"rvision"}},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{},"companiesGalleries":{},"companiesBanners":{},"companiesLandingVacancies":{},"companiesTechnologies":{},"workplaceInfo":null},"companyAdmin":{"companyInfo":null,"companyInfoLoading":false,"faqArticles":null,"brandingPreviewImageUrl":null,"jivoStatus":0,"adminNotifications":null},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":true},"flows":{"updates":{"countNewPostsBySubscription":null,"countNewPostsAll":28,"countNewNewsAll":12},"flows":[{"alias":"develop","id":"1","route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":"6","route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":"2","route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":"3","route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":"4","route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":"7","route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""}},"me":{"user":null,"uuid":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"modal":{"modals":[]},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"promoData":{"isLoading":false,"hasLoaded":false,"featurer":null,"megaposts":null,"promoLinks":null,"promoPosts":null},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"search":{"searchQueryError":null},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"stories":{"stories":[{"id":"story-256","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9f9\u002Fe16\u002Faa3\u002F9f9e16aa3959d9417693b87b33b5960a.png","title":"Хабр Карьера","link":"https:\u002F\u002Fu.habr.com\u002FfWIWD"},"title":"Карьерная неделя с победителями рейтинга","lang":"ru","startTime":"2023-02-22T13:00:00+03:00","finishTime":"2023-02-27T12:43:00+03:00","slides":[{"id":"story-256_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F412\u002F447\u002Fe40\u002F412447e40a7f9d7d0bc3def931a8f531.png","button":null},{"id":"story-256_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe5a\u002F945\u002F506\u002Fe5a94550609aa2470112448d69291f01.png","button":null},{"id":"story-256_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F68f\u002Ffd1\u002Fe00\u002F68ffd1e00991476e865643cfb0c1b7a3.png","button":{"title":"Перейти в канал","link":"https:\u002F\u002Fu.habr.com\u002FmZQU8","colorType":"light"}}]},{"id":"story-254","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7ca\u002Fd19\u002F564\u002F7cad19564e3da01131c205970297efed.png","title":"Хабр Новости","link":"https:\u002F\u002Fu.habr.com\u002FW9ecI"},"title":"Снимок мощной солнечной вспышки","lang":"ru","startTime":"2023-02-22T12:10:00+03:00","finishTime":"2023-03-05T11:56:00+03:00","slides":[{"id":"story-254_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1e5\u002F39c\u002Fd83\u002F1e539cd8310dbe3ebcb14cffc293a7ff.png","button":null},{"id":"story-254_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0cd\u002F0a3\u002F1a9\u002F0cd0a31a9f2ad25a56848a8c6fa7860e.png","button":null},{"id":"story-254_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd15\u002Faec\u002Fadd\u002Fd15aecadde84e134c75b642bdadad5f7.png","button":{"title":"Подробности","link":"https:\u002F\u002Fu.habr.com\u002FW9ecI","colorType":"light"}}]},{"id":"story-252","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff19\u002F48d\u002Fd15\u002Ff1948dd155701f88d36e11387c1660ef.png","title":"Geek Travel","link":"https:\u002F\u002Fu.habr.com\u002F9TZjL"},"title":"Где искать северное сияние в России","lang":"ru","startTime":"2023-02-21T11:35:00+03:00","finishTime":"2023-03-05T11:22:00+03:00","slides":[{"id":"story-252_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F506\u002F188\u002F83b\u002F50618883bc97ce517531018d3290d961.jpg","button":{"title":"К посту","link":"https:\u002F\u002Fu.habr.com\u002F9TZjL","colorType":"light"}},{"id":"story-252_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe42\u002Fa71\u002Fe8e\u002Fe42a71e8eb5583814647f5ad55f9e0ae.jpg","button":null},{"id":"story-252_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F685\u002Fdbe\u002F4ff\u002F685dbe4ffe3940eca28ede7406898846.jpg","button":null},{"id":"story-252_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F383\u002F63b\u002F1f4\u002F38363b1f459d5daace0e4502f0780737.jpg","button":null},{"id":"story-252_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F32b\u002F665\u002F0c4\u002F32b6650c448d698b9ca4dba128afb56e.jpg","button":null},{"id":"story-252_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F95e\u002F0b2\u002F5be\u002F95e0b25be55ae919dbebbac6142e670d.jpg","button":null},{"id":"story-252_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F616\u002F1d4\u002Ff84\u002F6161d4f849be8d4e4aeee88ea2e3d572.jpg","button":null}]},{"id":"story-250","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F09c\u002F0f6\u002F15d\u002F09c0f615db74086a1611243d250411eb.png","title":"Хабр","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fhabr\u002Fblog\u002F"},"title":"Лучшее из блогов компаний за неделю","lang":"ru","startTime":"2023-02-21T10:20:00+03:00","finishTime":"2023-02-28T15:20:00+03:00","slides":[{"id":"story-250_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff8d\u002F1f4\u002Fcc3\u002Ff8d1f4cc328fb5308a64c97976ad821a.jpg","button":null},{"id":"story-250_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fcf9\u002Fe08\u002F87e\u002Fcf9e0887eda5882faea090e93cfeb057.jpg","button":{"title":"Смотреть списки","link":"https:\u002F\u002Fu.habr.com\u002Fss-tt","colorType":"light"}},{"id":"story-250_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8db\u002Faae\u002F8d4\u002F8dbaae8d401dc775493cce70e4096a89.jpg","button":{"title":"Как это было","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fyandex\u002Fblog\u002F716524\u002F","colorType":"light"}},{"id":"story-250_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffe5\u002Fb10\u002F831\u002Ffe5b10831e5a6fbe445a2bd3de96c808.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fdododev\u002Fblog\u002F714512\u002F","colorType":"light"}},{"id":"story-250_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0c7\u002Fd91\u002Ff10\u002F0c7d91f101a28ab92af503dd97e9a511.jpg","button":{"title":"Читать советы","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fproductivity_inside\u002Fblog\u002F717108\u002F","colorType":"light"}},{"id":"story-250_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4ea\u002F32a\u002F3dc\u002F4ea32a3dc44b42aaf23c65c43dde62b1.jpg","button":{"title":"Окунуться в прошлое","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Ftimeweb\u002Fblog\u002F714894\u002F","colorType":"light"}},{"id":"story-250_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6f9\u002F3f3\u002F016\u002F6f93f30163ac0c7307ac32d74832049a.jpg","button":{"title":"Размышления","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fcloud4y\u002Fblog\u002F715668\u002F","colorType":"light"}},{"id":"story-250_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3e1\u002F35b\u002F17d\u002F3e135b17de83de5d5a9fd901e439221a.jpg","button":{"title":"Узнать больше","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F714946\u002F","colorType":"light"}}]},{"id":"story-246","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc41\u002F8cc\u002Fca9\u002Fc418ccca924faf05c11530c5071e627b.png","title":"Хабр Карьера","link":"https:\u002F\u002Fu.habr.com\u002Fitzp2022-new"},"title":"Зарплаты в IT во второй половине 2022","lang":"ru","startTime":"2023-02-20T11:05:00+03:00","finishTime":"2023-03-05T23:59:00+03:00","slides":[{"id":"story-246_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbe2\u002F07d\u002F19f\u002Fbe207d19f3cdc4b89e3618025c071ea0.png","button":null},{"id":"story-246_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fcda\u002F93e\u002Fed7\u002Fcda93eed762714814ddfc51c4712f4ed.png","button":null},{"id":"story-246_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb8a\u002Fde4\u002F87f\u002Fb8ade487fa6556af459e032adebf852d.png","button":null},{"id":"story-246_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8f6\u002Fb32\u002F844\u002F8f6b328448ed968a18a60a0cd745bd34.png","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002Fitzp2022-new","colorType":"dark"}}]},{"id":"story-222","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F312\u002Fabe\u002Fd4c\u002F312abed4c2617f05f485c19ae101de7e.png","title":"Хабр","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fhabr\u002Fblog\u002F"},"title":"Любовь, Хабр и роботы","lang":"ru","startTime":"2023-02-14T09:00:14+03:00","finishTime":"2023-02-26T23:59:00+03:00","slides":[{"id":"story-222_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd35\u002Fce5\u002F716\u002Fd35ce5716f14544be26d53e05dc155ab.jpg","button":null},{"id":"story-222_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F191\u002Fb9c\u002F449\u002F191b9c449738d2cb2333ffa8daa1bd39.jpg","button":{"title":"Читать переводы","link":"https:\u002F\u002Fu.habr.com\u002Fval1","colorType":"light"}},{"id":"story-222_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7c6\u002F61d\u002F6d9\u002F7c661d6d915ca10f037ccc7307fa36ec.jpg","button":{"title":"Что получилось?","link":"https:\u002F\u002Fu.habr.com\u002Fval2","colorType":"light"}},{"id":"story-222_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F02c\u002F20a\u002Fa28\u002F02c20aa28f1e1cb7d70943bd96eb5ac7.jpg","button":{"title":"Созерцать","link":"https:\u002F\u002Fu.habr.com\u002Fval3","colorType":"light"}},{"id":"story-222_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe94\u002F9d6\u002F03e\u002Fe949d603e63cf1c98dcc4597ba41abfa.jpg","button":{"title":"На свидание","link":"https:\u002F\u002Fu.habr.com\u002Fval4","colorType":"light"}},{"id":"story-222_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7b0\u002F3b3\u002Fed9\u002F7b03b3ed931ce73a0cda771b5e39c813.jpg","button":{"title":"Нашёл?","link":"https:\u002F\u002Fu.habr.com\u002Fval5","colorType":"light"}},{"id":"story-222_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F594\u002Fff6\u002Fbad\u002F594ff6badc0503fa3ca0dffafc31d3a3.jpg","button":{"title":"И сколько же?","link":"https:\u002F\u002Fu.habr.com\u002Fval6","colorType":"light"}},{"id":"story-222_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F452\u002Ff87\u002F9aa\u002F452f879aaf0db9530f35204663ec00e6.jpg","button":{"title":"Глянуть код","link":"https:\u002F\u002Fu.habr.com\u002Fval7","colorType":"light"}}]},{"id":"story-186","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb6b\u002F720\u002F180\u002Fb6b72018041811571246ddf5ef07bd33.png","title":"Сезоны Хабра","link":"https:\u002F\u002Fu.habr.com\u002Fstory_season-kuber"},"title":"Столкнуться с кубом","lang":"ru","startTime":"2023-02-01T11:30:00+03:00","finishTime":"2023-02-28T23:59:00+03:00","slides":[{"id":"story-186_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F2b0\u002F5e8\u002Fffb\u002F2b05e8ffb30634f0f7f5c9602d8e43e6.png","button":null},{"id":"story-186_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fdfb\u002F838\u002F9c1\u002Fdfb8389c197e915942f9144978b91ce4.png","button":null},{"id":"story-186_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F634\u002Fc42\u002Fdfd\u002F634c42dfddb260cdf37f9c9b9d3f34ea.png","button":null},{"id":"story-186_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F401\u002F9f5\u002F59e\u002F4019f559e6c090ded0b46d6deeb4883c.png","button":null},{"id":"story-186_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F82a\u002F9cd\u002Fa48\u002F82a9cda4870156765b749271aca48241.png","button":{"title":"Смотреть участников","link":"https:\u002F\u002Fu.habr.com\u002Fstory_season-kuber_members","colorType":"light"}}]},{"id":"story-152","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa49\u002F0d3\u002F609\u002Fa490d3609f29b6dfc53a7b88ab47ca64.png","title":"Хабр","link":"https:\u002F\u002Fu.habr.com\u002Fstory_HiM-anketa"},"title":"Сеньоры — очень странные люди","lang":"ru","startTime":"2023-01-23T11:00:00+03:00","finishTime":"2023-03-01T23:59:00+03:00","slides":[{"id":"story-152_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbbb\u002F901\u002F063\u002Fbbb9010630ae483ed1f41ec4e2572c13.png","button":null},{"id":"story-152_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4f8\u002F66c\u002F14f\u002F4f866c14f0ca8999334438d7f17c0e3a.png","button":null},{"id":"story-152_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6b9\u002Fa07\u002Fa61\u002F6b9a07a612df213ac3a1c179301828df.png","button":null},{"id":"story-152_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff6b\u002Fadb\u002Fb99\u002Ff6badbb9969d7e34ef4f7492767c6a77.png","button":null},{"id":"story-152_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd9c\u002F9ac\u002F878\u002Fd9c9ac878bec5b494699e0080dd2e813.png","button":null},{"id":"story-152_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fdb1\u002Faf9\u002Fc3b\u002Fdb1af9c3bb557f6cee698cf67610f977.png","button":null},{"id":"story-152_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5cf\u002Fbed\u002F65b\u002F5cfbed65bd20b7051b1aac2b9d6e807e.png","button":null},{"id":"story-152_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffa8\u002F251\u002F4a9\u002Ffa82514a9471cd455339e97178d8c021.png","button":null},{"id":"story-152_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbd5\u002F901\u002Fe95\u002Fbd5901e952d9cf638355a3cc8b0c0911.png","button":{"title":"Хочу помочь джуну","link":"https:\u002F\u002Fu.habr.com\u002Fstory_HiM-anketa","colorType":"light"}}]}]},"technotext":{"years":[],"technotextDocForNominees":null,"technotextDocForWinners":null,"technotextInfo":{},"technotextInfoLoading":false,"technotextWinners":{},"technotextWinnersLoading":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"userVotes":{"karmaVotesList":[],"karmaVotesPagesCount":null,"karmaVotesListLoading":false,"commentsVotesList":[],"commentsVotesPagesCount":null,"commentsVotesListLoading":false,"postsVotesList":[],"postsVotesPagesCount":null,"postsVotesListLoading":false,"userVotesList":[],"userVotesPagesCount":null,"userVotesListLoading":false},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"userSpecialization":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.2287bfbd.js" defer></script><script src="https://assets.habr.com/habr-web/js/7298.c8f1d73c.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.58744b80.js" defer></script>



    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-726094-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
<script src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true"></script>
</body>
</html>
